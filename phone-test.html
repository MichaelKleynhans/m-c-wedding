<!DOCTYPE html>
<html>
<head>
    <title>Phone Number Formatting Test</title>
</head>
<body>
    <h1>Phone Number Formatting Test</h1>
    <div id="results"></div>
    
    <script>
        // Phone number formatting function (same as in main file)
        function formatPhoneNumber(phoneNumber) {
            if (!phoneNumber) return phoneNumber;
            
            // Remove all non-digit characters except + at the beginning
            let cleanNumber = phoneNumber.replace(/[^\d+]/g, '');
            
            // If it starts with +27, keep it as is
            if (cleanNumber.startsWith('+27')) {
                return cleanNumber;
            }
            
            // If it starts with 027, convert to +27
            if (cleanNumber.startsWith('027')) {
                return '+27' + cleanNumber.substring(3);
            }
            
            // If it starts with 0 and is likely a SA number (10-11 digits total)
            if (cleanNumber.startsWith('0') && cleanNumber.length >= 10 && cleanNumber.length <= 11) {
                // Convert SA format: 0XX XXX XXXX to +27XX XXX XXXX
                return '+27' + cleanNumber.substring(1);
            }
            
            // For other international numbers starting with +, keep as is
            if (cleanNumber.startsWith('+')) {
                return cleanNumber;
            }
            
            // For any other number starting with 0, preserve it by adding a prefix
            if (cleanNumber.startsWith('0')) {
                return "'" + phoneNumber; // Excel/Sheets treats strings starting with ' as text
            }
            
            // Return as-is for other formats
            return phoneNumber;
        }
        
        // Test cases
        const testCases = [
            // South African numbers
            { input: '082 123 4567', expected: '+27821234567', description: 'SA mobile number with spaces' },
            { input: '0821234567', expected: '+27821234567', description: 'SA mobile number without spaces' },
            { input: '021 123 4567', expected: '+27211234567', description: 'SA landline with spaces' },
            { input: '0211234567', expected: '+27211234567', description: 'SA landline without spaces' },
            
            // Already formatted SA numbers
            { input: '+27 82 123 4567', expected: '+27821234567', description: 'Already formatted SA mobile' },
            { input: '+2782 123 4567', expected: '+27821234567', description: 'Already formatted SA mobile (no space after country code)' },
            { input: '027 82 123 4567', expected: '+27821234567', description: 'SA number with 027 prefix' },
            
            // International numbers
            { input: '+1 555 123 4567', expected: '+15551234567', description: 'US number' },
            { input: '+44 20 7123 4567', expected: '+442071234567', description: 'UK number' },
            
            // Edge cases
            { input: '012345', expected: "'012345", description: 'Short number starting with 0' },
            { input: '123456789', expected: '123456789', description: 'Number not starting with 0 or +' },
            { input: '', expected: '', description: 'Empty string' },
            { input: null, expected: null, description: 'Null value' }
        ];
        
        // Run tests
        const resultsDiv = document.getElementById('results');
        let html = '<h2>Test Results:</h2><ul>';
        let passedTests = 0;
        
        testCases.forEach((testCase, index) => {
            const result = formatPhoneNumber(testCase.input);
            const passed = result === testCase.expected;
            
            if (passed) passedTests++;
            
            html += `<li style="color: ${passed ? 'green' : 'red'}">
                <strong>Test ${index + 1}:</strong> ${testCase.description}<br>
                Input: "${testCase.input}" → Output: "${result}" 
                ${passed ? '✓ PASS' : `✗ FAIL (expected: "${testCase.expected}")`}
            </li>`;
        });
        
        html += '</ul>';
        html += `<h3>Summary: ${passedTests}/${testCases.length} tests passed</h3>`;
        
        resultsDiv.innerHTML = html;
    </script>
</body>
</html>